\NeedsTeXFormat{LaTeX2e}[1994/06/01]
\ProvidesPackage{chtt-notes}[2018/02/02 CHTT Course Notes]

\PassOptionsToPackage{utf8}{inputenc}
\PassOptionsToPackage{centercolon}{mathtools}

\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{amsthm}
\RequirePackage{fancyhdr}
\RequirePackage{inputenc}
\RequirePackage{mathpartir}
\RequirePackage{mathtools}
\RequirePackage{microtype}
\RequirePackage{natbib}
\RequirePackage{proof}
\RequirePackage{todonotes}
\RequirePackage{url}
\RequirePackage{xcolor}

% Reference management
\RequirePackage{xr}
\RequirePackage{xr-hyper}
\RequirePackage{hyperref}
% cleveref is really picky and really really wants to be loaded *last*
\RequirePackage{cleveref}

% Theorems
\newtheorem{theorem}{Theorem}
\newtheorem*{theorem*}{Theorem}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem*{corollary*}{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem*{lemma*}{Lemma}
\newtheorem{remark}[theorem]{Remark}
\newtheorem*{remark*}{Remark}
\newtheorem{claim}[theorem]{Attempt}
\newtheorem*{claim*}{Attempt}
\newtheorem{definition}[theorem]{Definition}
\newtheorem*{definition*}{Definition}
\newtheorem{exercise}[theorem]{Exercise}
\newtheorem*{exercise*}{Exercise}

\newenvironment{proofattempt}{\paragraph{\emph{Proof Attempt}.}}{\hfill\color{red}{X}\par}
\newenvironment{prfattemptref}[1]{\paragraph{\emph{Proof Attempt of #1}.}}{\hfill\color{red}{X}\par}

\newcommand{\redprl}{{\color{red}\textbf{Red}}\textbf{PRL}}

% Exact equality
\newcommand{\eeq}{\ensuremath{\doteq}}

\newcommand{\hasTF}[2]{\ensuremath{#1 \vdash #2\ \mathsf{type}}}
\newcommand{\hasEF}[3]{\ensuremath{#1 \vdash #2 : #3}}
\newcommand{\hasTEF}[3]{\ensuremath{#1 \vdash #2 \equiv #3\ \mathsf{type}}}
\newcommand{\hasEEF}[4]{\ensuremath{#1 \vdash #2 \equiv #3 : #4}}

\newcommand{\hasTC}[2]{\ensuremath{#1 \gg #2\ \mathsf{type}}}
\newcommand{\hasEC}[3]{\ensuremath{#1 \gg #2 \in #3}}
\newcommand{\hasTEC}[3]{\ensuremath{#1 \gg #2 \eeq #3\ \mathsf{type}}}
\newcommand{\hasEEC}[4]{\ensuremath{#1 \gg #2 \eeq #3 : #4}}

\newcommand{\hasC}[5]{\ensuremath{#1 : (#2 \rhd #3) \leadsto (#4 \rhd #5)}}

\newcommand{\htermop}{\mathsf{HT}}
\newcommand{\hterm}[2]{\ensuremath{\htermop_{#1}(#2)}}
\newcommand{\htermp}[2]{\ensuremath{\htermop^+_{#1}(#2)}}
\newcommand{\bterm}[1]{\ensuremath{{#1} \; \mathsf{term}_{\beta}}}
\newcommand{\hv}[2]{\ensuremath{\mathsf{HV}_{#1}(#2)}}
\newcommand{\hvcbn}[2]{\ensuremath{\mathsf{HV}^{\mathsf{cbn}}_{#1}(#2)}}
\newcommand{\hvcbv}[2]{\ensuremath{\mathsf{HV}^{\mathsf{cbv}}_{#1}(#2)}}

\newcommand{\contrb}[2]{#1 \mathrel{\text{contr}_\beta} #2}
\newcommand{\bnf}[1]{#1 \mathrel{\text{nf}_\beta}}
\newcommand{\bnorm}[1]{\ensuremath{#1 \mathrel{\text{norm}_\beta}}}
\newcommand{\stepb}[2]{\ensuremath{#1 \mapsto_{\beta} #2}}
\newcommand{\stepbs}[2]{\ensuremath{#1 \mapsto_{\beta}^* #2}}
\newcommand{\stepbk}[3]{\ensuremath{#1 \mapsto_{\beta}^{(#2)} #3}}

\newcommand{\hnorm}[3]{\ensuremath{\mathsf{HN}^{#1}_{#2}(#3)}}
\newcommand{\id}[1]{\ensuremath{\mathsf{id}(#1)}}

\newcommand{\AND}{\mathrel{\wedge}}
\newcommand{\OR}{\mathrel{\vee}}

\newcommand{\step}[2]{\ensuremath{#1 \mapsto #2}}
\newcommand{\steps}[2]{\ensuremath{#1 \mapsto^* #2}}
\newcommand{\eval}[2]{\ensuremath{#1 \mathrel{\Downarrow} #2}}
\newcommand{\valueJ}[1]{\ensuremath{#1\ \mathsf{value}}}
\newcommand{\fillin}[2]{\ensuremath{#1\{#2\}}}

\newcommand{\fn}[2]{\ensuremath{#1 \to #2}}
\newcommand{\nat}{\ensuremath{\mathsf{nat}}}
\newcommand{\void}{\ensuremath{\mathsf{void}}}
\newcommand{\bool}{\ensuremath{\mathsf{bool}}}
\newcommand{\vtrue}{\ensuremath{\mathsf{true}}}
\newcommand{\vfalse}{\ensuremath{\mathsf{false}}}
\newcommand{\tp}{\ensuremath{\mathsf{T}}}
\newcommand{\ap}[2]{\ensuremath{#1\ #2}}
\newcommand{\lam}[3]{\ensuremath{\lambda #1 {:} #2.\, #3}}
\newcommand{\inl}[1]{\ensuremath{1\cdot#1}}
\newcommand{\inr}[1]{\ensuremath{2\cdot#1}}
\newcommand{\scasev}[6]{\ensuremath{\mathsf{case}_{#1}\ #2\ \{\inl{#3} \hookrightarrow #4 \mid \inr{#5} \hookrightarrow #6\}}}
\newcommand{\scase}[5]{\ensuremath{\mathsf{case}_{#1}\ #2\ \{\inl{#3} \hookrightarrow #4 \mid \inr{#3} \hookrightarrow #5\}}}
\newcommand{\vcase}[2]{\ensuremath{\mathsf{case}_{#1}\ #2\ \{\,\}}}

\newcommand{\emptypair}{\ensuremath{\langle \rangle}}
\newcommand{\exprpair}[2]{\ensuremath{\langle #1, #2\rangle}}
\newcommand{\pairtype}[2]{\ensuremath{#1 \times #2}}
\newcommand{\booltype}{\text{bool}}
\newcommand{\unittype}{1}

\newcommand{\true}{\vtrue}
\newcommand{\false}{\vfalse}
\newcommand{\ifexpr}[3]{\ensuremath{\mathrm{if}(#1; #2; #3)}}
\newcommand{\ifexprtyp}[4]{\ensuremath{\mathrm{if}_{#1}(#2; #3; #4)}}
\newcommand{\letbein}[3]{\ensuremath{\mathrm{let}\ \langle#1\rangle\ \mathrm{be}\ #2\ \mathrm{in}\ #3}}

\newcommand{\subst}[3]{[#1/#2]#3}
\newcommand{\update}[3]{[#1 \mid #2 \mapsto #3]}

% System T
\newcommand{\natz}{\ensuremath{\mathsf{z}}}
\newcommand{\natsop}{\mathsf{s}}
\newcommand{\nats}[1]{\natsop(#1)}
\newcommand{\natrecop}{\mathsf{rec}}
\newcommand{\natrec}[5]{\ensuremath{\natrecop_{#1}\{#2; #3.#4\}(#5)}}

\DeclareMathOperator{\dom}{dom}

\newcommand{\E}{\mathcal{E}}

% Rule Name
\newcommand{\rn}[1]{\textsc{(#1)}}

% Page layout
\RequirePackage[paper=letterpaper,top=1in,bottom=1in,left=1.5in,right=1.5in,]{geometry}
\setlength{\parindent}{0mm}
\setlength{\parskip}{1.5mm}

% titles
\RequirePackage{titlesec}
\titleformat*{\section}{\large\bfseries}
\titleformat*{\subsection}{\normalsize\bfseries}
\titleformat*{\subsubsection}{\bfseries}
\titleformat*{\paragraph}{\bfseries}

% package to customize three basic list environments: enumerate, itemize and description.
\RequirePackage{enumitem}
%%% Let's not do the following indiscriminately, because it gives you overlapping
%%% subscripts and superscripts when one item has a subscript and the next item
%%% has a superscript.
%%% Besides, spacing makes it easier to read text.
%%% If you really want the following items, add them to the individual instance
%%% of itemize/enumerate/description. â€”RAK, 2018-02-02
% \setitemize{noitemsep, topsep=0pt, leftmargin=*}
%\setenumerate{noitemsep, topsep=0pt, leftmargin=*}
%\setdescription{noitemsep, topsep=0pt, leftmargin=*}

% title page, modified from article.cls
\makeatletter
\global\let\@week\@empty
\global\let\@scribes\@empty
\def\week#1{\def\@week{#1}}
\def\scribes#1{\def\@scribes{#1}}
\fancyhead[RO,LE]{\scshape 15-819: Computational Higher Type Theory}
\fancyhead[LO,RE]{\scshape Lecture Notes Week \@week}
\def\@maketitle{%
  \newpage
  \null
  \vskip 2em%
  \begin{center}%
    {\Large \scshape Computational Higher Type Theory (CHTT) \par}%
    \vskip 4pt%
    {\large \scshape Robert Harper \par}%
    \vskip 4pt%
    {\large\bfseries Lecture Notes of Week \@week\space by \@scribes}
  \end{center}%
  \par
  \pagestyle{fancy}
  \vskip 1.5em}
\makeatother
\pagestyle{fancy}

% Courtesy of
% https://www.sharelatex.com/learn/Kb/Cross_referencing_with_the_xr_package_in_ShareLaTeX
\makeatletter
\newcommand*{\addFileDependency}[1]{% argument=file name and extension
  \typeout{(#1)}
  \@addtofilelist{#1}
  \IfFileExists{#1}{}{\typeout{No file #1.}}
}
\makeatother

\newcommand*{\myexternaldocument}[2]{%
  \externaldocument[#2:]{#1}%
  \addFileDependency{#1.tex}%
  \addFileDependency{#1.aux}%
  \message{Added external document #1 with prefix ``#2:''.}
}

\makeatletter
\newcount\weekIncludeXR
\weekIncludeXR=1
\def\doXRs{\loop
  \myexternaldocument{week\the\weekIncludeXR}{W\the\weekIncludeXR}
  \advance\weekIncludeXR by +1
  \ifnum \weekIncludeXR<\@week
  \repeat}
\makeatother